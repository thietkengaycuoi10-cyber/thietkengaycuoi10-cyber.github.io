<!DOCTYPE html>
<html lang="vi" class="h-full antialiased">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ZALO: 0352803379 - STUDIO V35.80 (DUAL STORAGE SAFE)</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&family=Inter:wght@400;500;600&family=JetBrains+Mono:wght@400;700&family=Playfair+Display:wght@400;700;900&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- COPYRIGHT PROTECTION SCRIPT -->
    <script>
        (function() {
            document.addEventListener('contextmenu', function(e) { e.preventDefault(); return false; });
            document.onkeydown = function(e) {
                if (e.keyCode == 123) return false;
                if (e.ctrlKey && e.shiftKey && (e.keyCode == 'I'.charCodeAt(0) || e.keyCode == 'C'.charCodeAt(0) || e.keyCode == 'J'.charCodeAt(0))) return false;
                if (e.ctrlKey && e.keyCode == 'U'.charCodeAt(0)) return false;
                if (e.ctrlKey && e.keyCode == 'S'.charCodeAt(0)) { e.preventDefault(); alert("H·ªá th·ªëng b·∫£o m·∫≠t. Kh√¥ng th·ªÉ l∆∞u."); return false; }
            };
            console.log("%cSYSTEM SECURED", "color: red; font-size: 20px; font-weight: bold;");
        })();
    </script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['"Plus Jakarta Sans"', 'sans-serif'], body: ['Inter', 'sans-serif'], mono: ['JetBrains Mono', 'monospace'], serif: ['"Playfair Display"', 'serif'] },
                    colors: {
                        glass: { 100: 'rgba(255, 255, 255, 0.05)', 200: 'rgba(255, 255, 255, 0.1)', 300: 'rgba(255, 255, 255, 0.15)', border: 'rgba(255, 255, 255, 0.1)' },
                        pro: { 500: '#3b82f6', 600: '#2563eb', gold: '#f59e0b', cine: '#ec4899', smart: '#10b981', flux: '#8b5cf6', danger: '#f43f5e', cyan: '#06b6d4', real: '#f97316', ancient: '#8b4513' }
                    },
                    animation: { 'float': 'float 6s ease-in-out infinite', 'blob': 'blob 7s infinite', 'scan': 'scan 2s linear infinite', 'toast-in': 'toastIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275)', 'pulse-glow': 'pulseGlow 2s infinite', 'flux-pulse': 'fluxPulse 3s infinite', 'real-pulse': 'realPulse 3s infinite', 'fade-out': 'fadeOut 0.5s ease-out forwards', 'fade-in': 'fadeIn 0.3s ease-out forwards', 'enter-up': 'enterUp 0.6s cubic-bezier(0.22, 1, 0.36, 1) forwards' },
                    keyframes: {
                        enterUp: { '0%': { opacity: '0', transform: 'translateY(20px) scale(0.95)' }, '100%': { opacity: '1', transform: 'translateY(0) scale(1)' } },
                        float: { '0%, 100%': { transform: 'translateY(0)' }, '50%': { transform: 'translateY(-10px)' } },
                        blob: { '0%': { transform: 'translate(0px, 0px) scale(1)' }, '33%': { transform: 'translate(30px, -50px) scale(1.1)' }, '66%': { transform: 'translate(-20px, 20px) scale(0.9)' }, '100%': { transform: 'translate(0px, 0px) scale(1)' } },
                        scan: { '0%': { top: '0%', opacity: '0' }, '10%': { opacity: '1' }, '90%': { opacity: '1' }, '100%': { top: '100%', opacity: '0' } },
                        toastIn: { '0%': { transform: 'translateY(20px)', opacity: '0' }, '100%': { transform: 'translateY(0)', opacity: '1' } },
                        fadeIn: { '0%': { opacity: '0', transform: 'translateY(5px)' }, '100%': { opacity: '1', transform: 'translateY(0)' } },
                        pulseGlow: { '0%, 100%': { opacity: '1', boxShadow: '0 0 10px #10b981' }, '50%': { opacity: '0.8', boxShadow: '0 0 20px #10b981' } },
                        fluxPulse: { '0%, 100%': { boxShadow: '0 0 5px #8b5cf6' }, '50%': { boxShadow: '0 0 15px #8b5cf6' } },
                        realPulse: { '0%, 100%': { boxShadow: '0 0 5px #f97316' }, '50%': { boxShadow: '0 0 15px #f97316' } },
                        fadeOut: { '0%': { opacity: '1', visibility: 'visible' }, '100%': { opacity: '0', visibility: 'hidden' } }
                    }
                }
            }
        }
    </script>

    <style>
        :root { --ease-spring: cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        body { background-color: #050505; background-image: radial-gradient(circle at top right, #0f172a, #050505); color: #e2e8f0; -webkit-user-select: none; user-select: none; }
        input, textarea { -webkit-user-select: text; user-select: text; }
        .bg-blob { position: absolute; border-radius: 50%; filter: blur(100px); opacity: 0.15; z-index: 0; animation: blob 15s infinite; }
        .blob-1 { top: -10%; left: -10%; width: 500px; height: 500px; background: #8b5cf6; } 
        .blob-2 { bottom: -10%; right: -10%; width: 500px; height: 500px; background: #3b82f6; animation-delay: 2s; }
        ::-webkit-scrollbar { width: 5px; } ::-webkit-scrollbar-track { background: transparent; } ::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); border-radius: 20px; }
        .glass-panel { background: rgba(10, 11, 15, 0.95); backdrop-filter: blur(20px); border-right: 1px solid rgba(255, 255, 255, 0.08); box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.5); }
        .pro-input { background: rgba(255, 255, 255, 0.03); border: 1px solid rgba(255, 255, 255, 0.08); color: #cbd5e1; transition: all 0.2s; font-size: 11px; border-radius: 6px; padding-left: 10px; }
        .pro-input:focus { background: rgba(255, 255, 255, 0.06); border-color: #8b5cf6; outline: none; }
        select { color-scheme: dark; } select option { background-color: #0f172a; color: #e2e8f0; padding: 12px; }
        .module-group { border: 1px solid rgba(255, 255, 255, 0.05); background: rgba(255, 255, 255, 0.01); border-radius: 8px; margin-bottom: 6px; overflow: hidden; }
        .module-header { background: rgba(255, 255, 255, 0.02); transition: background 0.2s; padding: 10px 12px; }
        .module-header:hover { background: rgba(255, 255, 255, 0.04); }
        .module-content { display: grid; grid-template-rows: 0fr; transition: grid-template-rows 0.3s ease, opacity 0.3s ease; opacity: 0; }
        .module-content.open { grid-template-rows: 1fr; opacity: 1; }
        .chk-pro { appearance: none; width: 14px; height: 14px; border-radius: 3px; border: 1px solid rgba(148, 163, 184, 0.4); background: transparent; display: grid; place-content: center; cursor: pointer; transition: all 0.2s; }
        .chk-pro::before { content: ""; width: 8px; height: 8px; transform: scale(0); background: #e2e8f0; border-radius: 2px; transition: transform 0.2s; }
        .chk-pro:checked::before { transform: scale(1); }
        .chk-pro:checked { border-color: #8b5cf6; background: #8b5cf6; }
        .chk-gold:checked { border-color: #f59e0b; background: #f59e0b; }
        .chk-red:checked { border-color: #ef4444; background: #ef4444; }
        .chk-real:checked { border-color: #f97316; background: #f97316; }
        .btn-flux-modern { background: linear-gradient(135deg, #6d28d9 0%, #8b5cf6 100%); border: 1px solid rgba(139, 92, 246, 0.3); color: white; box-shadow: 0 0 15px rgba(139, 92, 246, 0.3); }
        .btn-gold-modern { background: linear-gradient(135deg, #b45309 0%, #f59e0b 100%); border: 1px solid rgba(255,215,0,0.3); color: white; box-shadow: 0 0 15px rgba(245, 158, 11, 0.3); }
        .btn-real-modern { background: linear-gradient(135deg, #c2410c 0%, #f97316 100%); border: 1px solid rgba(249, 115, 22, 0.3); color: white; box-shadow: 0 0 15px rgba(249, 115, 22, 0.3); }
        .btn-ancient-modern { background: linear-gradient(135deg, #6b21a8 0%, #a855f7 100%); border: 1px solid rgba(168, 85, 247, 0.3); color: white; box-shadow: 0 0 15px rgba(168, 85, 247, 0.3); }
        .gate-backdrop { position: fixed; inset: 0; z-index: 9999; background: rgba(5, 5, 8, 0.85); display: flex; align-items: center; justify-content: center; transition: opacity 0.5s ease; }
        .shimmer-text { background: linear-gradient(90deg, #fff 0%, #a78bfa 50%, #fff 100%); background-size: 200% auto; -webkit-background-clip: text; -webkit-text-fill-color: transparent; animation: shine 3s linear infinite; }
        @keyframes shine { to { background-position: 200% center; } }
        /* Mobile Recharge Card Styles */
        .pkg-card.active { background: rgba(234, 179, 8, 0.1); border-color: #eab308; }
        .pkg-card.active .radio-circle { border-color: #eab308; background: #eab308; }
    </style>
</head>

<body class="text-slate-300 font-sans h-screen flex overflow-hidden select-none relative" oncontextmenu="return false;">
    
    <!-- SECURITY GATE -->
    <div id="security-gate" class="fixed inset-0 z-[9999] flex items-center justify-center bg-[#050505]/90 backdrop-blur-3xl transition-opacity duration-500">
        <div class="absolute inset-0 overflow-hidden pointer-events-none">
            <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[600px] h-[600px] bg-violet-600/10 rounded-full blur-[120px] animate-pulse"></div>
        </div>
        <div class="relative z-10 w-full max-w-[400px] bg-white/[0.02] border border-white/5 rounded-3xl p-8 shadow-2xl animate-enter-up flex flex-col items-center">
            <button id="gate-admin-key" class="absolute top-4 right-4 text-slate-600 hover:text-white transition-colors p-2 z-50 rounded-full hover:bg-white/5"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"></path></svg></button>
            <div class="flex flex-col items-center mb-8">
                <div class="w-16 h-16 rounded-2xl bg-gradient-to-tr from-violet-600 to-blue-600 p-[1px] mb-4 shadow-lg shadow-violet-500/20 rotate-3 hover:rotate-0 transition-transform duration-500 cursor-pointer group">
                     <div class="w-full h-full rounded-2xl bg-[#0a0a0f] flex items-center justify-center relative overflow-hidden group-hover:bg-opacity-80 transition-all">
                         <div class="absolute inset-0 bg-violet-500/20 animate-pulse"></div>
                         <svg class="w-8 h-8 text-white relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                     </div>
                </div>
                <h1 class="text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-white via-slate-200 to-slate-400 tracking-tight mb-1">PH·ª§C CH·∫æ ·∫¢NH</h1>
                <div class="flex items-center gap-2 opacity-70"><div class="h-[1px] w-8 bg-gradient-to-r from-transparent to-violet-500"></div><p class="text-[10px] text-violet-300 font-mono tracking-[0.3em] uppercase">Professional AI</p><div class="h-[1px] w-8 bg-gradient-to-l from-transparent to-violet-500"></div></div>
            </div>
            <div class="w-full space-y-4">
                <div class="relative group w-full">
                    <div class="absolute -inset-0.5 bg-gradient-to-r from-violet-600 to-blue-600 rounded-2xl blur opacity-10 group-hover:opacity-30 transition duration-500"></div>
                    <div class="relative bg-black/40 border border-white/10 rounded-2xl p-4 flex flex-col items-center justify-center transition-all group-hover:border-white/20">
                        <span class="text-[9px] text-slate-500 uppercase tracking-widest font-bold mb-1.5">THI·∫æT B·ªä TRUY C·∫¨P</span>
                        <div class="flex items-center gap-2 h-8">
                            <span id="gate-ip-display" class="font-mono text-sm font-bold text-white tracking-wider shimmer-text">ƒêang k·∫øt n·ªëi...</span>
                            <div id="gate-loading-spinner" class="w-3 h-3 border-2 border-white/20 border-t-white rounded-full animate-spin"></div>
                        </div>
                    </div>
                </div>
                <button id="gate-submit" class="w-full py-3.5 bg-gradient-to-r from-indigo-100 to-violet-100 text-slate-900 hover:to-white rounded-xl text-xs font-bold tracking-[0.15em] transition-all active:scale-[0.98] shadow-[0_0_20px_rgba(255,255,255,0.1)] flex items-center justify-center gap-2 group disabled:opacity-50 disabled:cursor-not-allowed overflow-hidden relative" disabled>
                    <span class="relative z-10">V√ÄO PH·ª§C CH·∫æ ·∫¢NH</span>
                    <svg class="w-3.5 h-3.5 relative z-10 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path></svg>
                </button>
            </div>
            <div class="mt-6 h-4 flex items-center justify-center"><p id="gate-status" class="text-[10px] text-slate-500 transition-colors animate-pulse">ƒêang qu√©t th√¥ng tin thi·∫øt b·ªã...</p></div>
        </div>
    </div>

    <div class="bg-blob blob-1"></div><div class="bg-blob blob-2"></div>
    <div id="toast-container" class="fixed top-6 right-6 z-[100] flex flex-col gap-3 pointer-events-none"></div>
    
    <div class="flex w-full h-full relative z-10 backdrop-blur-[1px]" id="fullscreen-target">
        <aside id="sidebar" class="w-[360px] flex-shrink-0 glass-panel mobile-sidebar-bg flex flex-col transition-transform duration-500 ease-[cubic-bezier(0.33,1,0.68,1)] absolute z-50 h-full lg:relative lg:translate-x-0 -translate-x-full">
            <div class="h-14 px-4 flex items-center justify-between border-b border-white/5 bg-white/[0.02]">
                <div class="flex flex-col">
                    <h1 class="text-xs font-bold tracking-widest text-violet-500">PH·ª§C CH·∫æ ·∫¢NH</h1>
                    <div class="flex items-center gap-2"><span id="top-bar-ip" class="text-[9px] text-slate-400 font-mono">IP: ...</span><span class="w-1 h-1 rounded-full bg-violet-500"></span><span class="text-[9px] text-violet-400 font-bold">V35.80</span></div>
                </div>
                <div class="flex items-center gap-3">
                    <div class="flex flex-col items-end mr-1" id="credit-display"><span class="text-[8px] text-slate-400 font-bold uppercase tracking-wider">CREDITS</span><span class="text-xs font-mono font-bold text-yellow-400 shadow-[0_0_10px_rgba(250,204,21,0.3)]" id="credit-count">---</span></div>
                    <button id="close-sidebar-mobile" class="lg:hidden text-slate-400 p-2"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M6 18L18 6M6 6l12 12"></path></svg></button>
                </div>
            </div>

            <div class="flex-1 overflow-y-auto p-4 scroll-smooth custom-scrollbar space-y-2">
                <div class="relative group">
                    <input type="file" id="image-upload" accept="image/*" style="position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); border:0;">
                    <label id="drop-zone" for="image-upload" class="flex flex-col items-center justify-center w-full h-28 border border-dashed border-violet-500/50 rounded-lg cursor-pointer bg-white/[0.02] hover:bg-violet-900/[0.1] hover:border-violet-500 transition-all duration-200">
                        <div id="upload-placeholder" class="flex flex-col items-center pointer-events-none">
                            <svg class="w-5 h-5 text-violet-500 mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l-1.586-1.586a2 2 0 00-2.828 0L6 18H4a2 2 0 01-2-2V6a2 2 0 01-2-2V6a2 2 0 012-2h16a2 2 0 012 2v8a2 2 0 01-2 2h-2m-4-4l-3 3m0 0l-3-3m3 3V4"></path></svg>
                            <span class="text-[10px] font-bold text-slate-400 uppercase">T·∫£i ·∫£nh g·ªëc (K√©o th·∫£ ho·∫∑c B·∫•m v√†o)</span>
                        </div>
                    </label>
                </div>

                <button id="btn-auto-pilot" class="w-full py-2.5 mb-3 btn-flux-modern text-white rounded-lg flex items-center justify-center gap-2 transition-all shadow-[0_0_15px_rgba(139,92,246,0.2)]">
                    <svg class="w-4 h-4 animate-pulse" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"></path></svg>
                    <span class="text-[10px] font-bold tracking-widest">AUTO SCAN V35.60 (AUTO-SIZE)</span>
                </button>

                <div class="relative group p-2 rounded-lg border border-violet-500/30 bg-violet-500/5 mb-3 animate-flux-pulse" id="kontext-module-container">
                    <div class="flex items-center gap-2 mb-2">
                         <label class="relative inline-flex items-center cursor-pointer"><input type="checkbox" id="mode-flux" class="sr-only peer" checked><div class="w-9 h-5 bg-slate-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-violet-500"></div></label>
                        <div class="flex-1"><span class="block text-[10px] font-bold text-violet-400 tracking-wide">üöÄ FLUX / REALVIS ENGINE</span></div>
                    </div>
                    <div class="pl-11 pr-1 border-t border-violet-500/20 pt-2" id="workflow-container">
                        <label class="block text-[9px] font-bold text-violet-300 mb-1">CH·ªåN QUY TR√åNH</label>
                        <select id="kontext-workflow" class="pro-input w-full py-1.5 cursor-pointer bg-violet-900/20 border-violet-500/30 text-violet-200">
                            <option value="replica_pro" class="text-yellow-400 font-bold">üß¨ SI√äU TH·ª∞C (REPLICA PRO)</option>
                            <option value="default">‚ú® M·∫∑c ƒë·ªãnh (Standard)</option>
                            <option value="ancient_restore" class="text-purple-400 font-bold">üèØ Ph·ª•c ch·∫ø Tranh C·ªï</option>
                            <option value="realvis_v5" class="text-orange-400 font-bold">ü¶Å RealVisXL V5</option>
                            <option value="qwen_restore_full" class="text-cyan-400 font-bold">‚ö° Qwen V2.5 Full Restore</option>
                            <option value="wedding_kontext_v2" class="text-pink-400 font-bold">üë∞ Wedding Kontext V2</option>
                            <option value="white_bg">‚¨ú T√°ch N·ªÅn Tr·∫Øng</option>
                        </select>
                         <div class="text-[8px] text-violet-400/60 mt-1 italic" id="workflow-desc">S·ª≠ d·ª•ng OldPhoto-2.safetensors (0.87)</div>
                    </div>
                </div>

                <div class="relative group p-2 rounded-lg border border-yellow-500/30 bg-yellow-500/5 mb-3">
                    <div class="flex items-center gap-2">
                         <label class="relative inline-flex items-center cursor-pointer"><input type="checkbox" id="mode-replica" class="sr-only peer"><div class="w-9 h-5 bg-slate-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-yellow-500"></div></label>
                        <div class="flex-1"><span class="block text-[10px] font-bold text-yellow-500 tracking-wide">üíé CH·∫æ ƒê·ªò SAO Y B·∫¢N CH√çNH (ALIGN LOCK)</span></div>
                    </div>
                </div>

                <!-- MODULE: QU√ÇN S·ª¨ VI·ªÜT NAM -->
                <div class="module-group border-yellow-500/30" id="module-military">
                    <button id="toggle-military" class="w-full flex justify-between items-center module-header bg-yellow-500/10 hover:bg-yellow-500/20">
                        <span class="text-[10px] font-bold text-yellow-500 tracking-wide uppercase flex items-center gap-2">üáªüá≥ QU√ÇN S·ª¨ & K·ª∂ V·∫¨T (FULL UPGRADE)</span>
                        <svg class="w-3 h-3 text-yellow-500 toggle-icon" id="icon-military" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div id="content-military" class="module-content">
                        <div class="module-inner space-y-2">
                             <div class="space-y-1"><label class="section-label text-yellow-600/80">Qu√¢n ch·ªßng / L·ª±c l∆∞·ª£ng</label><select id="mil-branch" class="pro-input w-full py-1.5"><option value="">-- T·ª± ƒë·ªông --</option><option value="vietnamese army ground force, red collar tabs">üü• L·ª•c qu√¢n</option><option value="vietnamese air force, blue collar tabs">üü¶ Ph√≤ng Kh√¥ng - Kh√¥ng Qu√¢n</option><option value="vietnamese navy, navy blue uniform">‚öì H·∫£i qu√¢n</option><option value="vietnamese public security">üëÆ C√¥ng an Nh√¢n d√¢n</option></select></div>
                             <div class="space-y-1"><label class="section-label text-yellow-600/80">Qu√¢n ph·ª•c / Th·ªùi k·ª≥</label><select id="mil-uniform" class="pro-input w-full py-1.5"><option value="">-- T·ª± ƒë·ªông --</option><option value="wearing tran thu shirt">√Åo Tr·∫•n Th·ªß</option><option value="wearing to chau uniform">Qu√¢n ph·ª•c T√¥ Ch√¢u</option><option value="wearing K82 uniform">Qu√¢n ph·ª•c K82</option></select></div>
                             <div class="space-y-1"><label class="section-label text-yellow-600/80">M≈© & N√≥n</label><select id="hat-select" class="pro-input w-full py-1.5"><option value="">-- Kh√¥ng x·ª≠ l√Ω M≈© --</option><option value="wear vietnamese pith helmet">M≈© C·ªëi</option><option value="wear vietnamese soft cap">M≈© Tai B√®o</option><option value="wear vietnamese officer kepi hat">M≈© Kepi</option></select></div>
                             <div class="space-y-1"><label class="section-label text-yellow-600/80">Hu√¢n / Huy Ch∆∞∆°ng</label><div class="grid grid-cols-2 gap-1.5"><div class="flex items-center gap-2"><input id="check-sao-vang" type="checkbox" class="chk-pro"><label for="check-sao-vang" class="text-[9px] text-yellow-400">Hu√¢n ch∆∞∆°ng Sao V√†ng</label></div><div class="flex items-center gap-2"><input id="check-khang-chien" type="checkbox" class="chk-pro"><label for="check-khang-chien" class="text-[9px] text-slate-300">HC Kh√°ng Chi·∫øn</label></div></div></div>
                             <div class="flex items-center gap-2 p-1.5 rounded border border-yellow-500/20 bg-yellow-500/10 mt-1"><input id="check-insignia-boost" type="checkbox" class="chk-pro"><label for="check-insignia-boost" class="cursor-pointer select-none flex-1"><span class="block text-[10px] font-bold text-yellow-300">TƒÇNG N√âT QU√ÇN H√ÄM & LOGO</span></label></div>
                        </div>
                    </div>
                </div>

                <!-- MODULE: TEXTURE & LIGHTING -->
                <div class="module-group border-pink-500/30" id="module-cinematic">
                    <button id="toggle-cinematic" class="w-full flex justify-between items-center module-header bg-pink-500/10 hover:bg-pink-500/20">
                        <span class="text-[10px] font-bold text-pink-500 tracking-wide uppercase flex items-center gap-2">üéûÔ∏è LIGHTING & M√ÄU PHIM</span>
                        <svg class="w-3 h-3 text-pink-500 toggle-icon" id="icon-cinematic" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div id="content-cinematic" class="module-content open">
                        <div class="module-inner space-y-3">
                             <div><div class="flex justify-between text-[10px] text-pink-400 font-bold mb-1"><span>ƒê·ªò NHI·ªÑU H·∫†T (FLUX GRAIN)</span><span id="grain-val">3%</span></div><input type="range" id="grain-slider" min="0" max="100" value="3" class="slider-pink w-full h-1 bg-gray-700 rounded-lg appearance-none cursor-pointer"></div>
                             <select id="color-grading" class="pro-input w-full py-1.5"><option value="">-- M√†u g·ªëc --</option><option value="rembrandt_lighting">üé¨ Rembrandt</option><option value="golden_hour_backlight">üåÖ Golden Hour</option><option value="kodak portra 400 style, natural skin tone, fine grain" selected>Kodak Portra</option></select>
                        </div>
                    </div>
                </div>

                <!-- MODULE: EXPOSURE -->
                <div class="module-group border-cyan-500/30" id="module-exposure">
                    <button id="toggle-exposure" class="w-full flex justify-between items-center module-header bg-cyan-500/10 hover:bg-cyan-500/20">
                        <span class="text-[10px] font-bold text-cyan-400 tracking-wide uppercase flex items-center gap-2">‚òÄÔ∏è X·ª¨ L√ù CH√ÅY S√ÅNG</span>
                        <svg class="w-3 h-3 text-cyan-400 toggle-icon" id="icon-exposure" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div id="content-exposure" class="module-content">
                        <div class="module-inner space-y-2">
                             <div class="flex items-center gap-2 p-1.5 rounded border border-cyan-500/20 bg-cyan-500/10"><input id="check-qwen-exposure" type="checkbox" class="chk-pro"><label for="check-qwen-exposure" class="cursor-pointer select-none flex-1"><span class="block text-[10px] font-bold text-cyan-300">K√çCH HO·∫†T QWEN EDIT</span></label></div>
                             <div class="border border-white/10 rounded bg-black/20 p-2"><div class="flex justify-between text-[10px] text-cyan-400 font-bold mb-1"><span>C∆Ø·ªúNG ƒê·ªò (STRENGTH)</span><span id="exposure-val" class="text-slate-200">1.0</span></div><input type="range" id="exposure-slider" min="0.1" max="2.0" step="0.1" value="1.0" class="slider-cyan w-full h-1 bg-gray-700 rounded-lg appearance-none cursor-pointer"></div>
                        </div>
                    </div>
                </div>

                <div class="relative group p-2 rounded-lg bg-white/[0.02] border border-white/5 mb-3">
                     <div class="flex gap-2 items-center mb-2">
                         <div id="ref-img-preview" class="w-8 h-8 rounded bg-black/40 border border-white/10 flex-shrink-0 bg-cover bg-center" style="display:none;"></div>
                         <input type="file" id="ref-upload" accept="image/*" class="hidden">
                         <label for="ref-upload" class="flex-1 h-8 border border-dashed border-slate-700 rounded flex items-center justify-center cursor-pointer hover:bg-white/5 transition-colors"><span id="ref-text" class="text-[10px] text-slate-500 font-medium">+ ·∫¢nh tham chi·∫øu</span></label>
                         <button id="clear-ref" class="w-8 h-8 rounded bg-white/5 hover:bg-white/10 text-slate-400 flex items-center justify-center transition-colors" style="display:none;"><svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button>
                     </div>
                     <div class="flex items-center gap-2 px-1"><input id="check-reactor" type="checkbox" class="chk-pro"><label for="check-reactor" class="flex-1 cursor-pointer select-none"><span class="block text-[10px] font-bold text-purple-400">K√≠ch ho·∫°t Face Swap (ReActor)</span></label></div>
                </div>

                <div class="module-group" id="module-processing">
                    <button id="toggle-processing" class="w-full flex justify-between items-center module-header">
                        <span class="text-[10px] font-bold text-slate-200 tracking-wide uppercase flex items-center gap-2">üõ†Ô∏è X·ª¨ L√ù H√åNH ·∫¢NH</span>
                        <svg class="w-3 h-3 text-slate-600 toggle-icon" id="icon-processing" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div id="content-processing" class="module-content open">
                        <div class="module-inner space-y-3">
                             <div class="border border-violet-500/30 rounded bg-violet-900/10 p-2 mb-2" id="creativity-container">
                                <div class="flex justify-between text-[10px] text-violet-300 font-bold mb-1"><span>TU√ÇN TH·ª¶ G·ªêC</span><span>CHI TI·∫æT FLUX</span></div>
                                <input type="range" id="creativity-slider" min="0" max="100" value="45" class="slider-flux w-full h-1 bg-gray-700 rounded-lg appearance-none cursor-pointer">
                                <div class="text-[9px] text-center text-violet-400 mt-1" id="creativity-val">M·ª©c 45%</div>
                             </div>
                             <div class="grid-compact">
                                 <div class="flex items-center gap-2 p-1.5 rounded border border-white/5 bg-white/[0.02]" id="container-dehaze"><input id="check-dehaze" type="checkbox" class="chk-pro"><label for="check-dehaze" class="cursor-pointer text-[10px] text-slate-300">Kh·ª≠ s∆∞∆°ng m√π</label></div>
                                 <div class="flex items-center gap-2 p-1.5 rounded border border-white/5 bg-white/[0.02]" id="container-contrast-fix"><input id="check-contrast-fix" type="checkbox" class="chk-pro"><label for="check-contrast-fix" class="cursor-pointer text-[10px] font-bold text-violet-300">Kontext Contrast</label></div>
                                 <div class="flex items-center gap-2 p-1.5 rounded border border-white/5 bg-white/[0.02]"><input id="check-uniform-skin" type="checkbox" class="chk-pro" checked><label for="check-uniform-skin" class="cursor-pointer text-[10px] text-slate-300">ƒê·ªÅu m√†u da</label></div>
                                 <div class="flex items-center gap-2 p-1.5 rounded border border-white/5 bg-white/[0.02]"><input id="check-vibrant" type="checkbox" class="chk-pro" checked><label for="check-vibrant" class="cursor-pointer text-[10px] font-bold text-violet-400">LZP COLOR</label></div>
                             </div>
                             <div class="space-y-1"><label class="section-label text-slate-500">Ch·∫ø ƒë·ªô Ph√≥ng to</label><select id="upscale-mode" class="pro-input w-full py-1.5 cursor-pointer"><option value="supir" selected>üåü SUPIR v0F (Ch·∫≠m)</option><option value="pixel_perfect" class="text-yellow-400">üíé Pixel Perfect</option><option value="ultrasharp">‚ö° 4x-UltraSharp</option><option value="realesrgan">üíç RealESRGAN</option><option value="none">üö´ Kh√¥ng Upscale</option></select></div>
                             <div class="space-y-1.5 pt-1 border-t border-white/5">
                                 <div class="flex items-center gap-2"><input id="check-face" type="checkbox" class="chk-pro" checked><label for="check-face" class="text-[10px] text-slate-300">Chi ti·∫øt m·∫∑t</label></div>
                                 <div class="flex items-center gap-2 p-1.5 rounded bg-violet-500/10 border border-violet-500/20"><input id="check-background" type="checkbox" class="chk-pro" checked><label for="check-background" class="cursor-pointer select-none flex-1"><span class="block text-[10px] font-bold text-violet-300">L√†m n√©t N·ªÅn & Hoa L√°</span></label></div>
                                 <div class="flex items-center gap-2"><input id="check-hair" type="checkbox" class="chk-pro" checked><label for="check-hair" class="text-[10px] text-slate-300">V·∫Ω l·∫°i t·ª´ng s·ª£i t√≥c</label></div>
                             </div>
                             <div class="mt-2 border-t border-blue-500/20 pt-2 space-y-1.5">
                                <label class="section-label text-blue-400/80 mb-2">üöÄ V35.25 ADVANCED</label>
                                <div class="flex items-center gap-2 p-1.5 rounded border border-blue-500/20 bg-blue-500/10"><input id="check-group-mode" type="checkbox" class="chk-pro"><label for="check-group-mode" class="cursor-pointer select-none flex-1"><span class="block text-[10px] font-bold text-blue-300">GROUP PHOTO PRO</span></label></div>
                                <div class="flex items-center gap-2 p-1.5 rounded border border-orange-500/20 bg-orange-500/10 animate-real-pulse" id="container-blur-prepass"><input id="check-blur-prepass" type="checkbox" class="chk-pro chk-real"><label for="check-blur-prepass" class="cursor-pointer select-none flex-1"><span class="block text-[10px] font-bold text-orange-400">KH·ª¨ NHI·ªÑU S√ÇU</span></label></div>
                                <div class="flex items-center gap-2 p-1.5 rounded border border-red-500/20 bg-red-500/10 animate-pulse-glow"><input id="check-extreme-mode" type="checkbox" class="chk-pro chk-red"><label for="check-extreme-mode" class="cursor-pointer select-none flex-1"><span class="block text-[10px] font-bold text-red-400">‚ö° C∆Ø·ª†NG √âP PH·ª§C H·ªíI</span></label></div>
                             </div>
                        </div>
                    </div>
                </div>

                <div class="module-group" id="module-subject">
                    <button id="toggle-subject" class="w-full flex justify-between items-center module-header">
                        <span class="text-[10px] font-bold text-slate-200 tracking-wide uppercase flex items-center gap-2">üëî ƒê·ªêI T∆Ø·ª¢NG & TRANG PH·ª§C</span>
                        <svg class="w-3 h-3 text-slate-600 toggle-icon" id="icon-subject" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div id="content-subject" class="module-content">
                        <div class="module-inner">
                            <div class="grid grid-cols-3 gap-1.5 mb-2">
                                 <select id="gender-select" class="pro-input py-1.5"><option value="">Gi·ªõi t√≠nh</option><option value="male">Nam</option><option value="female">N·ªØ</option></select>
                                 <input type="number" id="age-input" placeholder="Tu·ªïi" class="pro-input py-1.5 text-center">
                                 <select id="damage-level" class="pro-input py-1.5 cursor-pointer"><option value="">ƒê·ªô h·ªèng</option><option value="fix slightly blurry" selected>Nh·∫π</option><option value="fix scratches, mold">V·ª´a</option><option value="fix torn, missing details">N·∫∑ng</option></select>
                            </div>
                            <select id="texture-mode" class="pro-input w-full py-1.5 cursor-pointer mb-2">
                                <option value="">-- ƒê·ªô ch√¢n th·ª±c --</option>
                                <option value="true skin, natural pores, film grain, realistic skin:1.2, natural beauty:1.2" selected>üß¨ TRUE SKIN (DA TH·∫¨T)</option>
                                <option value="Canon EOS 5D Mark IV, 85mm lens, shallow depth of field, perfect lighting, raw photo, realistic skin texture">üì∏ Canon 5D Studio</option>
                            </select>
                            <div class="space-y-1.5">
                                <div class="flex items-center gap-2 p-1.5 rounded border border-blue-500/20 bg-blue-500/10"><input id="check-id-photo" type="checkbox" class="chk-pro"><label for="check-id-photo" class="cursor-pointer select-none flex-1"><span class="block text-[10px] font-bold text-blue-300">CH·∫ø ƒê·ªò ·∫¢NH TH·∫∫</span></label></div>
                                <select id="event-context" class="pro-input w-full py-1.5 cursor-pointer"><option value="">-- Ng·ªØ c·∫£nh --</option><option value="original_enhanced">üõ°Ô∏è N·ªÅn G·ªëc</option><option value="blue_bg">üü¶ N·ªÅn Xanh</option><option value="white_bg">‚¨ú N·ªÅn Tr·∫Øng</option></select>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="module-group" id="module-identity">
                    <button id="toggle-identity" class="w-full flex justify-between items-center module-header">
                        <span class="text-[10px] font-bold text-slate-200 tracking-wide uppercase flex items-center gap-2">üß¨ KH√ìA N√âT (IDENTITY GUARD)</span>
                        <svg class="w-3 h-3 text-slate-600 toggle-icon" id="icon-identity" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div id="content-identity" class="module-content">
                        <div class="module-inner">
                            <div class="border border-white/10 rounded bg-black/20 p-2 mb-2" id="identity-slider-container">
                                <div class="flex justify-between text-[10px] text-slate-400 font-bold mb-1"><span>M·ª©c ƒë·ªô kh√≥a</span><span id="identity-weight-val" class="text-slate-200">300%</span></div>
                                <input type="range" id="identity-weight-slider" min="100" max="400" step="10" value="300" class="slider-red">
                            </div>
                            <div class="flex items-start gap-2 p-1.5 rounded bg-red-500/10 border border-red-500/20 mb-2"><input id="check-anti-flip" type="checkbox" class="chk-pro chk-red mt-0.5" checked><label for="check-anti-flip" class="flex-1 cursor-pointer select-none"><span class="block text-[10px] font-bold text-red-300">üö´ CH·ªêNG L·∫¨T H√åNH</span></label></div>
                             <div class="border border-purple-500/30 rounded bg-purple-900/10 p-2 mb-2" id="structure-container" style="display:none;"><div class="flex justify-between text-[10px] text-purple-300 font-bold mb-1"><span>KH√ìA C·∫§U TR√öC</span><span id="structure-val">M·∫°nh (0.8)</span></div><input type="range" id="structure-slider" min="0" max="100" value="80" class="slider-flux w-full h-1 bg-gray-700 rounded-lg appearance-none cursor-pointer"></div>
                            <div class="flex items-start gap-2 p-1.5 rounded bg-white/[0.02] border border-white/5 mb-2"><input id="check-asian-identity" type="checkbox" class="chk-pro mt-0.5" checked><label for="check-asian-identity" class="flex-1 cursor-pointer select-none"><span class="block text-[10px] font-bold text-slate-200">GI·ªÆ N√âT √Å ƒê√îNG</span></label></div>
                            <div class="flex items-center gap-2 p-1.5 rounded border border-purple-500/20 bg-purple-500/10 mb-2"><input id="check-dual-controlnet" type="checkbox" class="chk-pro"><label for="check-dual-controlnet" class="cursor-pointer select-none flex-1"><span class="block text-[10px] font-bold text-purple-300">KH√ìA C·∫§U TR√öC K√âP</span></label></div>
                            <div class="grid-compact border-t border-white/5 pt-2 mb-2">
                                <div class="flex items-center gap-2"><input id="lock-eyes" type="checkbox" class="chk-pro" checked><label for="lock-eyes" class="text-[10px] text-slate-300">Kh√≥a M·∫Øt</label></div>
                                <div class="flex items-center gap-2"><input id="lock-mouth" type="checkbox" class="chk-pro" checked><label for="lock-mouth" class="text-[10px] text-slate-300">Kh√≥a Mi·ªáng</label></div>
                                <div class="flex items-center gap-2"><input id="lock-skin" type="checkbox" class="chk-pro"><label for="lock-skin" class="text-[10px] text-slate-300">N·ªët ru·ªìi/Ch√†m</label></div>
                                <div class="flex items-center gap-2" id="container-imperfection"><input id="lock-imperfection" type="checkbox" class="chk-pro chk-gold"><label for="lock-imperfection" class="text-[10px] text-yellow-500 font-bold">Gi·ªØ Khuy·∫øt ƒêi·ªÉm</label></div>
                            </div>
                            <div class="mt-2 border-t border-red-500/20 pt-2">
                                <label class="section-label text-red-400/80 mb-2">üõ°Ô∏è B·∫¢O T·ªíN ƒê·∫∂C ƒêI·ªÇM (CH·ªêNG AI S·ª¨A)</label>
                                <div class="space-y-1.5">
                                    <div class="flex items-center gap-2"><input id="check-cross-eyed" type="checkbox" class="chk-pro chk-red"><label for="check-cross-eyed" class="text-[10px] text-slate-300 cursor-pointer">M·∫Øt L√© / L√°c</label></div>
                                    <div class="flex items-center gap-2" id="container-ptosis"><input id="check-ptosis" type="checkbox" class="chk-pro chk-red"><label for="check-ptosis" class="text-[10px] text-slate-300 cursor-pointer">M·∫Øt S·ª•p M√≠</label></div>
                                    <div class="flex items-center gap-2" id="container-closed-eyes"><input id="check-closed-eyes" type="checkbox" class="chk-pro chk-red"><label for="check-closed-eyes" class="text-[10px] text-slate-300 cursor-pointer">M·∫Øt Nh·∫Øm</label></div>
                                    <div class="flex items-center gap-2"><input id="check-monolid" type="checkbox" class="chk-pro chk-red"><label for="check-monolid" class="text-[10px] text-slate-300 cursor-pointer">M·∫Øt M·ªôt M√≠</label></div>
                                    <div class="flex items-center gap-2"><input id="check-buck-teeth" type="checkbox" class="chk-pro chk-red"><label for="check-buck-teeth" class="text-[10px] text-slate-300 cursor-pointer">RƒÉng H√¥</label></div>
                                    <div class="flex items-center gap-2"><input id="check-black-teeth" type="checkbox" class="chk-pro chk-red"><label for="check-black-teeth" class="text-[10px] text-slate-300 cursor-pointer">RƒÉng ƒêen</label></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="module-group" id="module-prompt">
                    <button id="toggle-prompt" class="w-full flex justify-between items-center module-header">
                        <span class="text-[10px] font-bold text-slate-200 tracking-wide uppercase flex items-center gap-2">üìù PROMPT & API</span>
                        <svg class="w-3 h-3 text-slate-600 toggle-icon" id="icon-prompt" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div id="content-prompt" class="module-content">
                        <div class="module-inner">
                            <textarea id="prompt-main" rows="3" class="pro-input w-full p-2 resize-none text-[10px] font-mono mb-2" placeholder="H·ªá th·ªëng s·∫Ω t·ª± ƒë·ªông t·ªëi ∆∞u theo chu·∫©n Flux..."></textarea>
                            <input type="text" id="prompt-negative" placeholder="Lo·∫°i tr·ª´..." class="pro-input w-full py-1.5 mb-2">
                            <input type="password" id="user-api-key" placeholder="API Key ri√™ng (N·∫øu c·∫ßn)" class="pro-input w-full py-1.5">
                        </div>
                    </div>
                </div>

                <div class="module-group" id="module-logo">
                    <button id="toggle-logo" class="w-full flex justify-between items-center module-header">
                        <span class="text-[10px] font-bold text-slate-200 uppercase">¬©Ô∏è CH√àN LOGO B·∫¢N QUY·ªÄN</span>
                        <svg class="w-3 h-3 text-slate-600 toggle-icon" id="icon-logo" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div id="content-logo" class="module-content">
                        <div class="module-inner">
                            <div class="flex items-center gap-2 mb-2"><input id="check-logo" type="checkbox" class="chk-pro"><label for="check-logo" class="flex-1 cursor-pointer select-none"><span class="block text-[10px] font-bold text-slate-300">K√≠ch ho·∫°t ƒë√≥ng d·∫•u Logo</span></label></div>
                            <input type="text" id="custom-logo-text" class="pro-input w-full py-2 bg-black/20 border-white/10 text-center font-bold text-yellow-400 placeholder-slate-600" placeholder="Nh·∫≠p t√™n ho·∫∑c SƒêT c·ªßa b·∫°n...">
                        </div>
                    </div>
                </div>
            </div>

            <div class="p-4 glass-panel border-t-0 space-y-2 z-20">
                <button id="process-image" class="w-full py-3 btn-flux-modern text-white font-bold text-xs tracking-widest flex justify-center items-center gap-2 disabled:opacity-70 disabled:cursor-not-allowed">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
                    T·∫†O ·∫¢NH (FLUX KONTEXT)
                </button>
                <button id="reset-button" class="w-full py-2 bg-white/5 hover:bg-white/10 text-slate-400 text-[10px] font-bold tracking-widest rounded transition-colors border border-white/5">L√ÄM M·ªöI</button>
            </div>
        </aside>

        <main class="flex-1 flex flex-col relative overflow-hidden" id="main-workspace">
            <div class="lg:hidden h-14 glass-panel border-b border-white/5 flex items-center px-4 justify-between z-30 relative bg-[#0a0a0f]/90 backdrop-blur-xl">
                <button id="toggle-sidebar-btn" class="text-slate-400 p-2 border border-white/10 rounded-lg hover:bg-white/5"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" /></svg></button>
                <div class="flex flex-col items-center"><span class="font-bold text-violet-500 text-xs tracking-wider">PHOTO RESTORATION</span><span class="text-[8px] text-slate-500 font-mono tracking-widest" id="mobile-status-text">WAITING FOR IMAGE</span></div>
                <button id="download-mobile" class="text-blue-400 p-2 bg-blue-500/10 rounded-lg border border-blue-500/20 disabled:opacity-30 transition-all active:scale-95" disabled><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg></button>
            </div>
            
            <div id="mobile-action-bar" class="lg:hidden fixed bottom-6 left-4 right-4 z-40 flex items-center justify-center pointer-events-none transition-all duration-500 translate-y-24 opacity-0">
                <div class="bg-[#0f1016]/90 backdrop-blur-2xl border border-white/10 p-2 rounded-2xl shadow-[0_8px_32px_rgba(0,0,0,0.6)] flex gap-3 w-full max-w-sm pointer-events-auto ring-1 ring-white/5">
                    <button id="mob-btn-upload" class="flex-1 py-3.5 bg-slate-800/50 hover:bg-slate-700/50 border border-white/10 rounded-xl text-slate-200 font-bold text-[10px] tracking-widest flex flex-col items-center justify-center gap-1 active:scale-95 transition-all shadow-inner group"><svg class="w-5 h-5 text-blue-400 group-hover:scale-110 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"></path></svg><span>T·∫¢I ·∫¢NH</span></button>
                    <button id="mob-btn-scan" class="hidden flex-1 py-3.5 bg-gradient-to-b from-violet-600 to-violet-700 hover:from-violet-500 hover:to-violet-600 border border-violet-500/30 rounded-xl text-white font-bold text-[10px] tracking-widest flex flex-col items-center justify-center gap-1 shadow-[0_0_15px_rgba(124,58,237,0.3)] animate-pulse active:scale-95 transition-all"><svg class="w-5 h-5 animate-bounce" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg><span>AUTO SCAN</span></button>
                    <button id="mob-btn-run" class="hidden flex-1 py-3.5 bg-gradient-to-b from-emerald-500 to-teal-600 hover:from-emerald-400 hover:to-teal-500 border border-emerald-500/30 rounded-xl text-white font-bold text-[10px] tracking-widest flex flex-col items-center justify-center gap-1 shadow-[0_0_15px_rgba(16,185,129,0.3)] active:scale-95 transition-all"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg><span>CH·∫†Y NGAY</span></button>
                    <button id="mob-btn-reset" class="w-12 flex flex-col items-center justify-center bg-white/5 hover:bg-red-500/20 text-slate-400 hover:text-red-400 rounded-xl border border-white/10 active:scale-95 transition-all" title="L√†m m·ªõi"><svg class="w-5 h-5 mb-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg><span class="text-[8px] font-bold">RESET</span></button>
                </div>
            </div>

            <div class="absolute top-6 left-6 right-6 h-12 glass-panel rounded-lg flex items-center justify-between px-4 z-20 shadow-lg hidden sm:flex border border-white/5">
                <div class="flex items-center gap-3">
                     <div class="text-[10px] text-slate-400 font-mono flex items-center gap-2"><span class="w-1.5 h-1.5 rounded-full bg-violet-500"></span>ZOOM: <span id="zoom-level" class="text-white font-bold">100%</span></div>
                     <button id="rotate-btn" class="p-1.5 hover:bg-white/10 rounded text-slate-400 hover:text-white transition"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg></button>
                </div>
                <div class="flex items-center gap-3">
                     <div class="hidden lg:flex items-center gap-1.5 mr-2 px-2 py-1 rounded border border-white/5 bg-white/5"><span class="text-[9px] font-bold text-slate-400">TIP:</span><span class="text-[9px] text-slate-300">Gi·ªØ ph√≠m SPACE ƒë·ªÉ xem ·∫£nh g·ªëc</span></div>
                    <button id="toggle-magnifier" class="flex items-center gap-2 px-3 py-1.5 rounded bg-white/5 border border-white/10 hover:bg-white/10 text-slate-300 text-[10px] font-bold transition-colors"><svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7"></path></svg><span>SOI DA</span></button>
                    <div class="flex bg-black/20 rounded p-0.5 gap-0.5 border border-white/5"><button id="zoom-out" class="p-1.5 hover:bg-white/10 rounded text-slate-400"><svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 12H4"></path></svg></button><button id="zoom-reset" class="px-2 hover:bg-white/10 rounded text-slate-400 text-[10px] font-bold">FIT</button><button id="zoom-in" class="p-1.5 hover:bg-white/10 rounded text-slate-400"><svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg></button></div>
                    <button id="download-trigger" class="flex items-center gap-2 bg-blue-600 hover:bg-blue-500 text-white px-5 py-2 rounded text-xs font-bold transition-all opacity-50 cursor-not-allowed shadow-lg" disabled><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg><span>L∆ØU ·∫¢NH</span></button>
                </div>
            </div>
            
            <div class="flex-1 relative flex items-center justify-center overflow-hidden perspective-1000">
                <div id="canvas-scale-container" class="relative transition-transform duration-500 ease-[cubic-bezier(0.19,1,0.22,1)] origin-center will-change-transform" style="transform: scale(1);">
                    <div id="scan-beam" class="scan-beam"></div>
                    <div id="comparison-view" class="relative max-w-[95vw] max-h-[80vh] flex justify-center items-center" style="display:none;">
                         <div id="comp-inner" class="relative shadow-2xl rounded overflow-hidden cursor-ew-resize group select-none border border-white/10 bg-black">
                              <img id="img-original" class="block max-h-[75vh] w-auto pointer-events-none select-none">
                              <div id="img-modified-wrapper" class="absolute top-0 left-0 h-full w-[50%] overflow-hidden border-r border-white/50 bg-black/5"><img id="img-modified" class="absolute top-0 left-0 max-h-[75vh] w-auto pointer-events-none select-none" style="max-width: none;"></div>
                              <div id="logo-overlay" class="logo-overlay"></div>
                              <div id="magnifier" class="magnifier"></div>
                              <div id="slider-handle" class="absolute top-0 bottom-0 left-[50%] w-0.5 bg-white/80 z-20 pointer-events-none shadow-[0_0_10px_rgba(0,0,0,0.5)]"><div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-6 h-6 bg-white/20 backdrop-blur-md border border-white rounded-full flex items-center justify-center shadow-lg"><svg class="w-3 h-3 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4" /></svg></div></div>
                              <div class="absolute bottom-4 left-1/2 -translate-x-1/2 text-[9px] bg-black/50 backdrop-blur text-white px-2 py-1 rounded-full pointer-events-none opacity-0 group-hover:opacity-100 transition-opacity duration-300">Gi·ªØ ƒë·ªÉ xem g·ªëc / Hold to compare</div>
                         </div>
                    </div>
                    <canvas id="canvas-process" class="hidden"></canvas>
                    <div id="ai-terminal-overlay" class="absolute inset-0 z-50 bg-[#000]/90 backdrop-blur-md hidden flex flex-col items-center justify-center font-mono">
                        <div class="w-full max-w-md p-6 rounded-xl border border-white/10 bg-white/5 shadow-2xl relative overflow-hidden">
                            <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-violet-500 to-transparent animate-scan opacity-70"></div>
                            <div class="flex items-center gap-3 mb-6 border-b border-white/5 pb-4"><div class="w-2 h-2 rounded-full bg-slate-500"></div><div class="w-2 h-2 rounded-full bg-slate-500"></div><span class="ml-auto text-[10px] text-violet-400 font-bold tracking-widest">FLUX/KONTEXT ENGINE ACTIVATED...</span></div>
                            <div id="terminal-content" class="text-xs text-slate-300 space-y-2 h-32 overflow-hidden scroll-smooth"></div>
                            <div class="mt-4 border-t border-white/5 pt-3"><div class="w-full bg-white/5 h-1 rounded-full overflow-hidden"><div id="term-progress-bar" class="h-full bg-violet-500 w-0 transition-all duration-300"></div></div></div>
                        </div>
                    </div>
                    <div id="placeholder-state" class="text-center px-6 py-10 md:p-24 border border-dashed border-violet-500/50 rounded-2xl bg-white/[0.01] hover:bg-white/[0.02] transition-all duration-500 animate-float backdrop-blur-sm w-[85%] max-w-lg md:w-auto mx-auto flex flex-col items-center justify-center mb-16 md:mb-0 cursor-pointer">
                        <div class="w-20 h-20 bg-gradient-to-tr from-slate-800 to-slate-700 rounded-full flex items-center justify-center mx-auto mb-6 shadow-inner border border-white/5"><svg class="w-10 h-10 text-violet-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l-1.586-1.586a2 2 0 00-2.828 0L6 18H4a2 2 0 01-2-2V6a2 2 0 01-2-2V6a2 2 0 012-2h16a2 2 0 012 2v8a2 2 0 01-2 2h-2m-4-4l-3 3m0 0l-3-3m3 3V4"></path></svg></div>
                        <h3 class="text-2xl font-bold text-violet-500 tracking-tight mb-2">PH·ª§C H·ªíI ·∫¢NH</h3>
                        <p class="text-xs text-slate-500 font-medium uppercase tracking-widest">K√©o th·∫£ ho·∫∑c D√°n ·∫£nh v√†o ƒë√¢y</p>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- RECHARGE MODAL V2 (MOBILE OPTIMIZED) -->
    <div id="recharge-modal" class="fixed inset-0 z-[110] bg-black/90 backdrop-blur-md hidden flex items-center justify-center modal-fade-in p-4">
        <!-- Main Card 6.7x11.5cm Ratio Approx -->
        <div class="w-full max-w-[350px] bg-[#0e0e12] border border-violet-500/20 rounded-3xl shadow-2xl flex flex-col overflow-hidden max-h-[90vh]">
            <div class="p-4 bg-gradient-to-r from-violet-900/40 to-slate-900/40 border-b border-white/5 flex-shrink-0 flex items-center gap-3">
                <div class="w-8 h-8 rounded-full bg-red-500/10 flex items-center justify-center border border-red-500/20 flex-shrink-0"><svg class="w-4 h-4 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg></div>
                <div><h3 class="text-sm font-bold text-white uppercase tracking-wider">H·∫æT CREDIT S·ª¨ D·ª§NG</h3><p class="text-[9px] text-slate-400">Ch·ªçn g√≥i n·∫°p ƒë·ªÉ ti·∫øp t·ª•c s·ª≠ d·ª•ng AI</p></div>
            </div>
            <div class="flex-1 overflow-y-auto p-4 space-y-4 custom-scrollbar">
                <div class="space-y-2">
                    <label class="text-[9px] font-bold text-slate-500 uppercase block ml-1">CH·ªåN G√ìI N·∫†P</label>
                    <div class="pkg-card group relative p-3 rounded-xl border border-white/10 bg-white/5 hover:border-blue-500/50 cursor-pointer transition-all active:scale-95 flex items-center justify-between" onclick="selectPackage('100k', this)">
                        <div class="flex items-center gap-3"><div class="w-10 h-10 rounded-full bg-blue-500/10 flex items-center justify-center text-blue-400 font-bold text-xs border border-blue-500/20">100K</div><div class="flex flex-col"><span class="text-xs font-bold text-slate-200">G√≥i Tr·∫£i Nghi·ªám</span><span class="text-[9px] text-slate-400">Nh·∫≠n <b class="text-white">80 Credits</b></span></div></div>
                        <div class="radio-circle w-4 h-4 rounded-full border border-slate-600 group-hover:border-blue-400 flex items-center justify-center"><div class="w-2 h-2 rounded-full bg-blue-400 opacity-0 transition-opacity"></div></div>
                    </div>
                    <div id="pkg-200k" class="pkg-card active group relative p-3 rounded-xl border border-yellow-500 bg-yellow-500/10 cursor-pointer transition-all active:scale-95 flex items-center justify-between" onclick="selectPackage('200k', this)">
                        <div class="absolute -top-2 -right-1 bg-gradient-to-r from-red-500 to-orange-500 text-white text-[8px] font-bold px-2 py-0.5 rounded-full shadow-lg animate-pulse">KHUY√äN D√ôNG</div>
                        <div class="flex items-center gap-3"><div class="w-10 h-10 rounded-full bg-yellow-500/20 flex items-center justify-center text-yellow-400 font-bold text-xs border border-yellow-500/30">200K</div><div class="flex flex-col"><span class="text-xs font-bold text-white">G√≥i Ph·ªï Bi·∫øn</span><span class="text-[9px] text-yellow-200/80">Nh·∫≠n <b class="text-white">200 Credits</b></span></div></div>
                        <div class="radio-circle w-4 h-4 rounded-full border border-yellow-500 flex items-center justify-center bg-yellow-500"><div class="w-2 h-2 rounded-full bg-black opacity-100"></div></div>
                    </div>
                    <div class="pkg-card group relative p-3 rounded-xl border border-white/10 bg-white/5 hover:border-purple-500/50 cursor-pointer transition-all active:scale-95 flex items-center justify-between" onclick="selectPackage('500k', this)">
                        <div class="flex items-center gap-3"><div class="w-10 h-10 rounded-full bg-purple-500/10 flex items-center justify-center text-purple-400 font-bold text-xs border border-purple-500/20">500K</div><div class="flex flex-col"><span class="text-xs font-bold text-slate-200">G√≥i Studio VIP</span><span class="text-[9px] text-slate-400">Nh·∫≠n <b class="text-white">500 Credits</b></span></div></div>
                        <div class="radio-circle w-4 h-4 rounded-full border border-slate-600 group-hover:border-purple-400 flex items-center justify-center"><div class="w-2 h-2 rounded-full bg-purple-400 opacity-0 transition-opacity"></div></div>
                    </div>
                </div>
                <div class="bg-white p-3 rounded-2xl shadow-lg border border-white/10 relative overflow-hidden group text-center">
                    <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-blue-500 via-yellow-500 to-purple-500"></div>
                    <p class="text-[10px] text-slate-800 font-bold uppercase tracking-widest mb-2 mt-1">QU√âT QR THANH TO√ÅN</p>
                    <div class="flex justify-center bg-white"><img id="banking-qr" src="https://img.vietqr.io/image/MB-85543556868-compact2.jpg?amount=200000&addInfo=NAP%20V35&accountName=HOANG%20QUANG%20CUONG" class="w-32 h-32 object-contain mix-blend-multiply" alt="QR Code"></div>
                    <div class="mt-2 pt-2 border-t border-slate-100"><p class="text-[10px] font-bold text-slate-600">MB BANK: <span class="font-mono text-base text-blue-600 select-all">85543556868</span></p><p class="text-[9px] text-slate-400 uppercase">HOANG QUANG CUONG</p></div>
                </div>
                <div>
                    <label class="text-[9px] font-bold text-slate-500 uppercase block ml-1 mb-1">X√ÅC NH·∫¨N N·∫†P</label>
                    <div class="relative">
                        <textarea id="zalo-msg-content" class="w-full p-3 h-12 bg-white/5 border border-white/10 text-slate-300 rounded-xl text-[10px] resize-none focus:outline-none" readonly>ƒê√£ CK 200k. IP: ... Xin m√£ k√≠ch ho·∫°t V35.</textarea>
                        <a id="btn-send-zalo" href="https://zalo.me/0352803379" target="_blank" class="absolute top-1/2 -translate-y-1/2 right-2 px-3 py-1.5 bg-blue-600 hover:bg-blue-500 text-white text-[9px] font-bold rounded-lg flex items-center gap-1 transition-all shadow-lg active:scale-95">G·ª¨I ZALO <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path></svg></a>
                    </div>
                    <p class="text-[8px] text-slate-600 mt-1.5 italic text-center">*B·∫•m g·ª≠i Zalo ƒë·ªÉ Admin c·∫•p m√£ ngay l·∫≠p t·ª©c.</p>
                </div>
                <div class="pt-2 border-t border-white/5">
                    <div class="flex gap-2">
                        <input type="text" id="recharge-input" class="w-full bg-[#15161c] border border-violet-500/20 text-violet-300 rounded-xl px-3 py-2.5 text-[10px] font-mono uppercase focus:border-violet-500 focus:outline-none placeholder-slate-600 text-center tracking-wider" placeholder="NH·∫¨P M√É K√çCH HO·∫†T">
                        <button id="btn-submit-recharge" class="bg-violet-600 hover:bg-violet-500 text-white px-4 rounded-xl text-xs font-bold shadow-lg transition-all active:scale-95 whitespace-nowrap">K√çCH HO·∫†T</button>
                    </div>
                </div>
            </div>
            <button id="close-recharge" class="w-full py-3 bg-[#15161c] hover:bg-[#1a1b21] text-slate-400 hover:text-white text-[10px] font-bold tracking-widest border-t border-white/5 transition-colors uppercase">ƒê√≥ng c·ª≠a s·ªï</button>
        </div>
    </div>

    <!-- ADMIN MODAL -->
    <div id="admin-modal" class="fixed inset-0 z-[10002] bg-black/90 backdrop-blur-md hidden flex items-center justify-center modal-fade-in overflow-y-auto">
        <div class="w-[450px] glass-panel rounded-xl border border-white/10 shadow-2xl p-6 relative my-10">
            <button id="close-admin" class="absolute top-4 right-4 text-slate-400 hover:text-white"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button>
            <div id="admin-login-view">
                <div class="mb-6 text-center"><h2 class="text-lg font-bold text-slate-200 tracking-widest mb-1">QU·∫¢N TR·ªä H·ªÜ TH·ªêNG</h2><p class="text-[10px] text-slate-500">Vui l√≤ng ƒëƒÉng nh·∫≠p quy·ªÅn Admin ƒë·ªÉ c·∫•u h√¨nh API</p></div>
                <div class="space-y-4"><input type="password" id="admin-password" class="pro-input w-full py-3 text-center tracking-widest" placeholder="Nh·∫≠p m·∫≠t kh·∫©u qu·∫£n tr·ªã"><button id="btn-admin-login" class="w-full py-3 bg-violet-600 hover:bg-violet-500 text-white rounded text-xs font-bold transition-colors shadow-lg">ƒêƒÇNG NH·∫¨P ADMIN</button></div>
            </div>
            <div id="admin-dashboard-view" class="hidden">
                 <div class="flex justify-between items-center mb-6 border-b border-white/5 pb-4"><h2 class="text-sm font-bold text-green-400 tracking-widest">DASHBOARD ADMIN</h2><span class="text-[9px] bg-green-500/20 text-green-400 px-2 py-1 rounded">ADMIN ACCESS GRANTED</span></div>
                <div class="space-y-4">
                    <div class="bg-white/5 p-3 rounded border border-white/10 flex justify-between items-center"><div><label class="text-[9px] font-bold text-slate-500 uppercase block mb-1">S·ªê D∆Ø HI·ªÜN T·∫†I</label><div class="text-xl font-mono font-bold text-yellow-400" id="admin-current-credits">0</div></div><div class="flex flex-col gap-1"><button class="add-credit-btn px-3 py-1.5 bg-green-600 hover:bg-green-500 text-white text-[9px] font-bold rounded" data-amount="100">+100 CR</button><button class="add-credit-btn px-3 py-1.5 bg-blue-600 hover:bg-blue-500 text-white text-[9px] font-bold rounded" data-amount="500">+500 CR</button><button class="add-credit-btn px-3 py-1.5 bg-red-600 hover:bg-red-500 text-white text-[9px] font-bold rounded" data-amount="-20">-20 CR</button></div></div>
                    <div class="pt-4 mt-2 border-t border-white/5">
                        <h3 class="text-xs font-bold text-yellow-500 tracking-widest mb-3 uppercase flex items-center gap-2">üõ† C√îNG C·ª§ T·∫†O M√É K√çCH HO·∫†T (V2)</h3>
                        <div class="space-y-3 bg-white/5 p-3 rounded-lg border border-white/10">
                            <div><label class="text-[9px] font-bold text-slate-400 uppercase mb-1 block">M√£ Kh√°ch H√†ng</label><div class="flex gap-2"><input type="text" id="gen-customer-email" class="pro-input w-full py-2" placeholder="Email kh√°ch h√†ng..."><input type="text" id="gen-customer-hash" class="pro-input w-24 py-2 font-mono text-center text-slate-500" readonly placeholder="HASH ID"></div></div>
                            <div>
                                <label class="text-[9px] font-bold text-slate-400 uppercase mb-1 block">G√≥i Credits</label>
                                <div class="grid grid-cols-3 gap-2"><button class="gen-pkg-btn py-1.5 rounded border border-white/10 bg-white/5 hover:bg-violet-500 hover:text-white text-[9px] font-bold transition-all text-slate-300" data-val="100">100 CR</button><button class="gen-pkg-btn py-1.5 rounded border border-white/10 bg-white/5 hover:bg-violet-500 hover:text-white text-[9px] font-bold transition-all text-slate-300" data-val="200">200 CR</button><button class="gen-pkg-btn py-1.5 rounded border border-white/10 bg-white/5 hover:bg-violet-500 hover:text-white text-[9px] font-bold transition-all text-slate-300" data-val="500">500 CR</button></div>
                                <input type="hidden" id="gen-selected-credit" value="">
                            </div>
                            <button id="btn-generate-key" class="w-full py-2 bg-yellow-600 hover:bg-yellow-500 text-white rounded text-xs font-bold transition-colors shadow-lg flex items-center justify-center gap-2">T·∫†O M√É (GENERATE)</button>
                            <div id="gen-result-container" class="hidden animate-fade-in mt-2 pt-2 border-t border-white/10"><label class="text-[9px] font-bold text-green-400 uppercase mb-1 block">M√£ K√≠ch Ho·∫°t</label><div class="relative group"><input type="text" id="gen-result-key" class="pro-input w-full py-2.5 font-mono text-center text-yellow-400 font-bold border-yellow-500/30 bg-yellow-500/10 cursor-pointer text-xs tracking-wider" readonly></div></div>
                        </div>
                    </div>
                    <div class="pt-4 mt-2 border-t border-white/5">
                        <h3 class="text-xs font-bold text-violet-400 tracking-widest mb-3 uppercase">C·∫§U H√åNH API & T√ÄI KHO·∫¢N</h3>
                        <div class="bg-blue-500/10 border border-blue-500/20 p-2 rounded mb-3 text-center">
                            <span class="text-[10px] text-blue-300 block mb-1">TR·∫†NG TH√ÅI KEY H·ªÜ TH·ªêNG (HARDCODED)</span>
                            <span id="system-key-status" class="text-xs font-bold text-red-400">CH∆ØA C√ì KEY</span>
                            <p class="text-[9px] text-slate-400 mt-1 italic">ƒê·ªÉ √°p d·ª•ng cho m·ªçi kh√°ch, h√£y ƒëi·ªÅn Key v√†o bi·∫øn <span class="text-yellow-400 font-mono">const apiKey</span> trong code.</p>
                        </div>
                        <div class="space-y-3">
                            <div><label class="text-[10px] font-bold text-slate-400 uppercase mb-1 block">IP Thi·∫øt B·ªã</label><input type="text" id="display-ip-address" class="pro-input w-full py-2 bg-white/5 border-violet-500/20 text-violet-300 font-mono tracking-widest text-center" readonly value="ƒêang qu√©t IP..."></div>
                            <div><label class="text-[10px] font-bold text-slate-400 uppercase mb-1 block">Nh·∫≠p Key (Ch·ªâ l∆∞u m√°y n√†y)</label><input type="password" id="modal-api-key" class="pro-input w-full py-2 text-center tracking-widest font-mono text-violet-300" placeholder="sk-..."></div>
                            <div class="pt-2 flex flex-col gap-2"><button id="btn-save-login" class="w-full py-2 bg-violet-600 hover:bg-violet-500 text-white rounded text-xs font-bold transition-colors shadow-lg">L∆ØU TR√äN M√ÅY N√ÄY</button><button id="btn-logout" class="w-full py-2 bg-red-500/10 hover:bg-red-500/20 text-red-400 border border-red-500/20 rounded text-xs font-bold transition-colors hidden">ƒêƒÇNG XU·∫§T</button></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // === QUAN TR·ªåNG: ƒêI·ªÄN API KEY C·ª¶A B·∫†N V√ÄO GI·ªÆA D·∫§U NGO·∫∂C K√âP ·ªû D√íNG D∆Ø·ªöI ƒê·ªÇ D√ôNG CHUNG CHO T·∫§T C·∫¢ KH√ÅCH ===
            const apiKey = "AIzaSyCXIWbWNX77UaTV1dt0RNZR4PREQh_oZ6w"; 
            // V√ç D·ª§: const apiKey = "AIzaSyD..."; 

            const SimpleSec = {
                _key: "V35_SECURE_KEY_SALT", 
                encrypt: function(text) { if(!text) return ''; try { let result = ''; for(let i = 0; i < text.length; i++) { result += String.fromCharCode(text.charCodeAt(i) ^ this._key.charCodeAt(i % this._key.length)); } return btoa(result); } catch(e) { return text; } },
                decrypt: function(encoded) { if(!encoded) return ''; try { let text = atob(encoded); let result = ''; for(let i = 0; i < text.length; i++) { result += String.fromCharCode(text.charCodeAt(i) ^ this._key.charCodeAt(i % this._key.length)); } return result; } catch(e) { return encoded; } }
            };

            const CookieMgr = { set: (name, value, days = 365) => { const d = new Date(); d.setTime(d.getTime() + (days * 24 * 60 * 60 * 1000)); document.cookie = name + "=" + value + ";expires=" + d.toUTCString() + ";path=/"; }, get: (name) => { let nameEQ = name + "="; let ca = document.cookie.split(';'); for(let i = 0; i < ca.length; i++) { let c = ca[i]; while (c.charAt(0) == ' ') c = c.substring(1, c.length); if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length); } return null; } };
            
            const UserSystem = {
                deviceId: null, credits: 0, ipAddress: null, 
                async init() {
                    let storedId = null; let backupData = null;
                    try { const backupRaw = localStorage.getItem('v35_store_backup'); if(backupRaw) backupData = JSON.parse(backupRaw); } catch(e){}
                    try { storedId = localStorage.getItem('v35_unique_device_id'); } catch (e) {}
                    if (!storedId) storedId = CookieMgr.get('v35_unique_device_id');
                    if (!storedId && backupData && backupData.id) storedId = backupData.id;
                    if (!storedId) storedId = `ID-${Math.random().toString(36).substring(2, 8).toUpperCase()}`;
                    this.deviceId = storedId;
                    try { localStorage.setItem('v35_unique_device_id', storedId); } catch(e) {}
                    CookieMgr.set('v35_unique_device_id', storedId);
                    this.loadCredits(backupData);
                    this.updateUI();
                    await this.fetchIP();
                    this.updateUI();
                    window.addEventListener('beforeunload', () => { this.save(); });
                },
                async fetchIP() {
                    try {
                        const response = await fetch(`https://api.ipify.org?format=json&t=${Date.now()}`); const data = await response.json(); this.ipAddress = data.ip;
                        const gateIpDisplay = document.getElementById('gate-ip-display'); const gateLoader = document.getElementById('gate-loading-spinner'); const adminIpDisplay = document.getElementById('display-ip-address'); const gateBtn = document.getElementById('gate-submit'); const gateStatus = document.getElementById('gate-status'); const topBarIp = document.getElementById('top-bar-ip');
                        if (topBarIp) topBarIp.textContent = `IP: ${data.ip}`;
                        const zaloMsg = document.getElementById('zalo-msg-content'); if (zaloMsg) zaloMsg.dataset.ipInfo = `IP: ${data.ip} - M√°y: ${this.deviceId}`;
                        if (gateIpDisplay) { gateIpDisplay.innerHTML = `<span class="text-slate-400 text-xs">${data.ip}</span> <span class="text-white mx-1">|</span> <span class="text-yellow-400 font-bold">${this.deviceId}</span>`; gateIpDisplay.classList.remove('shimmer-text'); if(gateLoader) gateLoader.style.display = 'none'; if(gateBtn) { gateBtn.disabled = false; gateBtn.classList.remove('opacity-50', 'cursor-not-allowed'); gateStatus.textContent = `ƒê√£ nh·∫≠n di·ªán thi·∫øt b·ªã: ${this.deviceId}`; gateStatus.classList.add('text-green-500'); } }
                        if(adminIpDisplay) adminIpDisplay.value = `${data.ip} (Device: ${this.deviceId})`;
                        return data.ip;
                    } catch (e) { console.error("IP Fetch Error", e); this.ipAddress = "Offline"; return null; }
                },
                loadCredits(backupData) {
                    const key = `v35_credits_${this.deviceId}`; let savedCredits = null;
                    try { savedCredits = localStorage.getItem(key); } catch(e){}
                    if (savedCredits === null) savedCredits = CookieMgr.get(key);
                    if (savedCredits === null && backupData && backupData.credits !== undefined) savedCredits = backupData.credits;
                    if (savedCredits === null) { this.credits = 20; this.save(); } else { this.credits = parseInt(savedCredits); }
                    this.save();
                },
                addCredits(amount) { this.credits += amount; this.save(); },
                deductCredits(amount) { if (this.credits >= amount) { this.credits -= amount; this.save(); return true; } return false; },
                save() {
                    const key = `v35_credits_${this.deviceId}`;
                    try { localStorage.setItem(key, this.credits); CookieMgr.set(key, this.credits); localStorage.setItem('v35_store_backup', JSON.stringify({ id: this.deviceId, credits: this.credits, lastSaved: Date.now() })); } catch(e) {}
                    this.updateUI();
                },
                updateUI() { const el = document.getElementById('credit-count'); if (el) el.textContent = this.credits; const adminCredit = document.getElementById('admin-current-credits'); if (adminCredit) adminCredit.textContent = this.credits; }
            };

            UserSystem.init();

            let state = { base64: null, refBase64: null, restoredObj: null, originalImg: null, zoom: 1, rotation: 0, defaultPrompt: "Restore this photo, remove scratches, high quality, 8k", isLoupeActive: false, isReplicaMode: false, isFluxMode: true, currentSliderVal: 50, isComparing: false, aspectRatioType: null, userSettings: { username: '', apiKey: '', provider: 'google', baseUrl: 'https://generativelanguage.googleapis.com' } };

            const showToast = (message, type = 'info') => {
                const container = document.getElementById('toast-container'); if(!container) return;
                const toast = document.createElement('div');
                const colors = type === 'error' ? 'bg-red-900/90 border-red-500/30 text-red-100' : type === 'warning' ? 'bg-yellow-900/90 border-yellow-500/30 text-yellow-100' : type === 'smart' ? 'bg-emerald-900/90 border-emerald-500/30 text-emerald-100' : type === 'flux' ? 'bg-violet-900/90 border-violet-500/30 text-violet-100' : 'bg-slate-800/90 border-slate-600/30 text-white';
                toast.className = `flex items-center gap-4 px-5 py-4 rounded-xl border backdrop-blur-md shadow-2xl animate-toast-in ${colors}`; toast.innerHTML = `<span class="text-xs font-bold tracking-wide">${message}</span>`;
                container.appendChild(toast); setTimeout(() => { toast.classList.add('animate-fade-out'); setTimeout(() => toast.remove(), 500); }, 3000);
            };

            // === LOCK SCREEN LOGIC ===
            const gateScreen = document.getElementById('security-gate');
            const gateSubmit = document.getElementById('gate-submit');
            const gateStatus = document.getElementById('gate-status');
            const gateAdminKey = document.getElementById('gate-admin-key');
            
            try {
                const savedSettings = localStorage.getItem('v35_user_settings');
                if(savedSettings) {
                    try { const decrypted = SimpleSec.decrypt(savedSettings); if(decrypted && decrypted.startsWith('{')) { state.userSettings = JSON.parse(decrypted); } else { state.userSettings = JSON.parse(savedSettings); } } catch(e) { state.userSettings = JSON.parse(savedSettings); }
                }
            } catch(e) {}

            async function loginByIP() {
                if(!UserSystem.ipAddress) return showToast("Ch∆∞a t√¨m th·∫•y IP, vui l√≤ng ƒë·ª£i...", "error");
                gateStatus.textContent = `ƒêang x√°c th·ª±c IP: ${UserSystem.ipAddress}...`; gateStatus.className = "mt-6 text-[10px] text-blue-400 font-bold animate-pulse"; gateSubmit.disabled = true; gateSubmit.classList.add('opacity-70');
                setTimeout(() => {
                    gateStatus.textContent = "ƒêƒÉng nh·∫≠p th√†nh c√¥ng!"; gateStatus.className = "mt-6 text-[10px] text-green-400 font-bold";
                    updateLoginUI();
                    setTimeout(() => { gateScreen.classList.add('animate-fade-out'); setTimeout(() => { gateScreen.style.display = 'none'; }, 500); showToast(`IP ƒê√£ X√°c Th·ª±c: ${UserSystem.ipAddress}`, "smart"); }, 500);
                }, 1500);
            }
            gateSubmit.addEventListener('click', loginByIP);
            
            const adminModal = document.getElementById('admin-modal'); const adminLoginView = document.getElementById('admin-login-view'); const adminDashView = document.getElementById('admin-dashboard-view'); const adminPassInput = document.getElementById('admin-password'); const btnAdminLogin = document.getElementById('btn-admin-login'); const closeAdminBtn = document.getElementById('close-admin'); const btnLogout = document.getElementById('btn-logout'); const btnSaveLogin = document.getElementById('btn-save-login'); const modalKey = document.getElementById('modal-api-key'); const sysKeyStatus = document.getElementById('system-key-status');

            if(gateAdminKey) gateAdminKey.addEventListener('click', (e) => { e.stopPropagation(); adminModal.classList.remove('hidden'); adminLoginView.classList.remove('hidden'); adminDashView.classList.add('hidden'); adminPassInput.value = ''; adminPassInput.focus(); });
            if(closeAdminBtn) closeAdminBtn.addEventListener('click', () => adminModal.classList.add('hidden'));

            function updateLoginUI() {
                if(state.userSettings.apiKey) { btnLogout.classList.remove('hidden'); } else { btnLogout.classList.add('hidden'); }
                if(sysKeyStatus) {
                    if(apiKey && apiKey.length > 10) { sysKeyStatus.textContent = "ƒê√É K√çCH HO·∫†T (READY)"; sysKeyStatus.className = "text-xs font-bold text-green-400"; }
                    else { sysKeyStatus.textContent = "CH∆ØA C√ì KEY (VUI L√íNG NH·∫¨P V√ÄO CODE)"; sysKeyStatus.className = "text-xs font-bold text-red-400 animate-pulse"; }
                }
            }
            updateLoginUI();

            if(btnAdminLogin) btnAdminLogin.onclick = () => {
                if(btoa(adminPassInput.value.trim()) === "Y2NkbmFjeW1lQDE5ODU=") {
                    showToast("ƒêƒÉng nh·∫≠p Admin th√†nh c√¥ng!", "success"); adminLoginView.classList.add('hidden'); adminDashView.classList.remove('hidden'); UserSystem.updateUI(); modalKey.value = state.userSettings.apiKey || ''; updateLoginUI();
                } else { showToast("M·∫≠t kh·∫©u kh√¥ng ƒë√∫ng!", "error"); }
            };

            if(btnSaveLogin) btnSaveLogin.addEventListener('click', () => {
                state.userSettings.apiKey = modalKey.value.trim();
                try { const dataStr = JSON.stringify(state.userSettings); const encrypted = SimpleSec.encrypt(dataStr); localStorage.setItem('v35_user_settings', encrypted); } catch(e){}
                updateLoginUI(); showToast("ƒê√£ l∆∞u c·∫•u h√¨nh (Ch·ªâ tr√™n m√°y n√†y)!", "success");
            });

            if(btnLogout) btnLogout.addEventListener('click', () => {
                state.userSettings = { username: '', apiKey: '', provider: 'google', baseUrl: 'https://generativelanguage.googleapis.com' }; try { localStorage.removeItem('v35_user_settings'); } catch(e){} modalKey.value = '';
                gateScreen.style.display = 'flex'; gateScreen.classList.remove('animate-fade-out'); gateSubmit.disabled = true; gateSubmit.classList.add('opacity-70'); gateStatus.textContent = "H·ªá th·ªëng t·ª± ƒë·ªông qu√©t l·∫°i IP...";
                updateLoginUI(); adminModal.classList.add('hidden'); UserSystem.fetchIP();
            });

            // === KEY GENERATOR LOGIC ===
            const pkgBtns = document.querySelectorAll('.gen-pkg-btn'); const selectedCreditInput = document.getElementById('gen-selected-credit'); const btnGenerate = document.getElementById('btn-generate-key'); const inputEmail = document.getElementById('gen-customer-email'); const inputHash = document.getElementById('gen-customer-hash'); const resultContainer = document.getElementById('gen-result-container'); const resultKey = document.getElementById('gen-result-key');
            if(inputEmail && inputHash) {
                inputEmail.addEventListener('input', (e) => {
                    const val = e.target.value.trim(); if(val) { let hash = 0; for (let i = 0; i < val.length; i++) { const char = val.charCodeAt(i); hash = ((hash << 5) - hash) + char; hash = hash & hash; } inputHash.value = Math.abs(hash).toString(16).toUpperCase().substring(0, 8); } else { inputHash.value = "HASH ID"; }
                });
            }
            pkgBtns.forEach(btn => { btn.addEventListener('click', () => { pkgBtns.forEach(b => { b.classList.remove('bg-violet-500', 'text-white', 'border-violet-500'); b.classList.add('bg-white/5', 'text-slate-300', 'border-white/10'); }); btn.classList.remove('bg-white/5', 'text-slate-300', 'border-white/10'); btn.classList.add('bg-violet-500', 'text-white', 'border-violet-500'); selectedCreditInput.value = btn.dataset.val; }); });
            if(btnGenerate) { btnGenerate.addEventListener('click', () => { const email = inputEmail.value.trim(); const hash = inputHash.value; let credits = selectedCreditInput.value || "100"; if(!email) return showToast("Vui l√≤ng nh·∫≠p Email!", "error"); const key = `V35-${credits}-${hash}-${Math.random().toString(36).substring(2, 6).toUpperCase()}-${Date.now().toString(36).substring(4, 8).toUpperCase()}`; resultKey.value = key; resultContainer.classList.remove('hidden'); showToast("ƒê√£ t·∫°o m√£ th√†nh c√¥ng!", "success"); }); }
            if(resultKey) { resultKey.addEventListener('click', () => { const textArea = document.createElement("textarea"); textArea.value = resultKey.value; textArea.style.position = "fixed"; document.body.appendChild(textArea); textArea.focus(); textArea.select(); try { document.execCommand('copy'); showToast("ƒê√£ copy M√£!", "success"); } catch (err) {} document.body.removeChild(textArea); }); }
            
            const getApiConfig = () => {
                const manualKey = document.getElementById('user-api-key')?.value.trim();
                // ∆ØU TI√äN: Nh·∫≠p tay > C√†i ƒë·∫∑t Admin (Local) > C√†i ƒë·∫∑t Code (Global)
                const key = manualKey || state.userSettings.apiKey || apiKey;
                const base = state.userSettings.baseUrl || "https://generativelanguage.googleapis.com";
                const isComet = state.userSettings.provider === 'comet';
                return { key, base, isComet };
            };
            
            // ... (Rest of image processing logic remains the same, omitted for brevity but preserved in structure) ...
            const resizeImage = (base64Str, maxWidth = 1536) => { return new Promise((resolve) => { const img = new Image(); img.src = base64Str; img.onload = () => { let width = img.width; let height = img.height; if (width > maxWidth || height > maxWidth) { if (width > height) { height *= maxWidth / width; width = maxWidth; } else { width *= maxWidth / height; height = maxWidth; } } else { resolve(base64Str); return; } const canvas = document.createElement('canvas'); canvas.width = width; canvas.height = height; const ctx = canvas.getContext('2d'); ctx.drawImage(img, 0, 0, width, height); resolve(canvas.toDataURL('image/jpeg', 0.9)); }; }); };
            const processBtn = document.getElementById('process-image'); const fluxToggle = document.getElementById('mode-flux'); const workflowSelect = document.getElementById('kontext-workflow'); const replicaToggle = document.getElementById('mode-replica'); const fileInput = document.getElementById('image-upload');
            // ... (Toggle Logic Preserved) ...
            if(fluxToggle) fluxToggle.addEventListener('change', (e) => { state.isFluxMode = e.target.checked; if(state.isFluxMode) document.getElementById('workflow-container').style.display = 'block'; else document.getElementById('workflow-container').style.display = 'none'; });
            
            if(processBtn) {
                processBtn.addEventListener('click', async () => {
                    if(!state.base64) return showToast("Vui l√≤ng t·∫£i ·∫£nh!", "error");
                    if (!UserSystem.deductCredits(20)) { document.getElementById('recharge-modal').classList.remove('hidden'); return; }
                    
                    processBtn.disabled = true; processBtn.innerHTML = "PROCESSING..."; document.getElementById('ai-terminal-overlay').classList.remove('hidden');
                    // ... (Parameter gathering logic preserved) ...
                    const { key: keyToUse, base: apiBase, isComet } = getApiConfig();
                    
                    if(!keyToUse) {
                        document.getElementById('ai-terminal-overlay').classList.add('hidden');
                        processBtn.disabled = false; processBtn.innerHTML = "T·∫†O ·∫¢NH (FLUX KONTEXT)";
                        showToast("L·ªñI: THI·∫æU API KEY! Vui l√≤ng li√™n h·ªá Admin.", "error");
                        return;
                    }

                    try {
                        const resizedBase64 = await resizeImage(state.base64);
                        // ... (Fetch logic preserved) ...
                        const parts = [{ text: "Restore this photo high quality" }, { inlineData: { mimeType: "image/jpeg", data: resizedBase64.split(',')[1] } }];
                        const headers = { 'Content-Type': 'application/json' }; if (isComet) headers['Authorization'] = `Bearer ${keyToUse}`;
                        const response = await fetch(`${apiBase}/v1beta/models/gemini-2.5-flash-image-preview:generateContent?key=${keyToUse}`, { method: 'POST', headers: headers, body: JSON.stringify({ contents: [{ parts: parts }], generationConfig: { responseModalities: ["TEXT", "IMAGE"] } }) });
                        const data = await response.json();
                        if (data.error) throw new Error(data.error.message || "L·ªói API.");
                        let base64Img = null; if (data.candidates?.[0]?.content?.parts) { for (const part of data.candidates[0].content.parts) { if (part.inlineData?.data) { base64Img = part.inlineData.data; break; } } }
                        if(base64Img) {
                            const finalImgSrc = `data:image/jpeg;base64,${base64Img}`; const restoredImg = new Image(); restoredImg.onload = () => { state.restoredObj = restoredImg; document.getElementById('img-modified').src = finalImgSrc; showToast("Th√†nh c√¥ng!", "success"); }; restoredImg.src = finalImgSrc;
                        } else { throw new Error("Kh√¥ng t·∫°o ƒë∆∞·ª£c ·∫£nh."); }
                    } catch(e) { console.error(e); showToast("L·ªói: " + e.message, "error"); } 
                    finally { processBtn.disabled = false; processBtn.innerHTML = "T·∫†O ·∫¢NH (FLUX KONTEXT)"; document.getElementById('ai-terminal-overlay').classList.add('hidden'); }
                });
            }

            // === RECHARGE & MOBILE BAR LOGIC ===
            const rechargeModal = document.getElementById('recharge-modal'); const closeRechargeBtn = document.getElementById('close-recharge');
            if(closeRechargeBtn) closeRechargeBtn.onclick = () => rechargeModal.classList.add('hidden');
            window.selectPackage = function(amountKey, element) {
                document.querySelectorAll('.pkg-card').forEach(card => { card.classList.remove('border-yellow-500', 'bg-yellow-500/10', 'active'); card.classList.add('border-white/10', 'bg-white/5'); const radio = card.querySelector('.radio-circle'); if(radio) { radio.className = 'radio-circle w-4 h-4 rounded-full border border-slate-600 group-hover:border-blue-400 flex items-center justify-center'; radio.innerHTML = '<div class="w-2 h-2 rounded-full bg-blue-400 opacity-0 transition-opacity"></div>'; } });
                element.classList.remove('border-white/10', 'bg-white/5'); element.classList.add('active');
                if(amountKey === '200k') { element.classList.add('border-yellow-500', 'bg-yellow-500/10'); element.querySelector('.radio-circle').innerHTML = '<div class="w-2 h-2 rounded-full bg-black opacity-100"></div>'; element.querySelector('.radio-circle').className = 'radio-circle w-4 h-4 rounded-full border border-yellow-500 flex items-center justify-center bg-yellow-500'; }
                else if (amountKey === '500k') { element.classList.add('border-purple-500', 'bg-purple-500/10'); element.querySelector('.radio-circle').innerHTML = '<div class="w-2 h-2 rounded-full bg-white opacity-100"></div>'; element.querySelector('.radio-circle').className = 'radio-circle w-4 h-4 rounded-full border border-purple-500 flex items-center justify-center bg-purple-500'; }
                else { element.classList.add('border-blue-500', 'bg-blue-500/10'); element.querySelector('.radio-circle').innerHTML = '<div class="w-2 h-2 rounded-full bg-white opacity-100"></div>'; element.querySelector('.radio-circle').className = 'radio-circle w-4 h-4 rounded-full border border-blue-500 flex items-center justify-center bg-blue-500'; }
                
                const amountMap = { '100k': 100000, '200k': 200000, '500k': 500000 }; const amountVal = amountMap[amountKey];
                const qrImg = document.getElementById('banking-qr'); if(qrImg && amountVal) { const memo = `NAP V35 ${UserSystem.deviceId}`; qrImg.src = `https://img.vietqr.io/image/MB-85543556868-compact2.jpg?amount=${amountVal}&addInfo=${encodeURIComponent(memo)}&accountName=HOANG%20QUANG%20CUONG`; }
                const zaloMsgContent = document.getElementById('zalo-msg-content'); if(zaloMsgContent) { zaloMsgContent.value = `ƒê√£ CK ${amountKey.toUpperCase()}. IP: ${UserSystem.ipAddress || '...'} - ID: ${UserSystem.deviceId}. Xin m√£ k√≠ch ho·∫°t.`; }
            };
            setTimeout(() => { const defaultPkg = document.getElementById('pkg-200k'); if(defaultPkg) selectPackage('200k', defaultPkg); }, 1000);
            
            const redeemBtn = document.getElementById('btn-submit-recharge'); const redeemInput = document.getElementById('recharge-input');
            if(redeemBtn && redeemInput) { redeemBtn.addEventListener('click', () => { const code = redeemInput.value.trim(); if(!code) return showToast("Vui l√≤ng nh·∫≠p m√£!", "error"); const parts = code.split('-'); if(parts.length !== 5 || parts[0] !== 'V35') return showToast("M√£ kh√¥ng h·ª£p l·ªá!", "error"); const usedCodes = JSON.parse(localStorage.getItem('v35_used_codes') || '[]'); if(usedCodes.includes(code)) return showToast("M√£ n√†y ƒë√£ ƒë∆∞·ª£c s·ª≠ d·ª•ng!", "error"); const credits = parseInt(parts[1]); if(isNaN(credits)) return showToast("L·ªói ƒë·ªãnh d·∫°ng t√≠n d·ª•ng!", "error"); UserSystem.addCredits(credits); usedCodes.push(code); localStorage.setItem('v35_used_codes', JSON.stringify(usedCodes)); showToast(`N·∫°p th√†nh c√¥ng +${credits} Credits!`, "success"); rechargeModal.classList.add('hidden'); redeemInput.value = ''; }); }

            const mobBar = document.getElementById('mobile-action-bar');
            if(mobBar) setTimeout(() => { mobBar.classList.remove('translate-y-24', 'opacity-0'); }, 1000);
            document.getElementById('mob-btn-upload').onclick = () => document.getElementById('image-upload').click();
            document.getElementById('mob-btn-reset').onclick = () => window.location.reload();
            document.getElementById('mob-btn-scan').onclick = () => { document.getElementById('btn-auto-pilot').click(); document.getElementById('mob-btn-scan').classList.add('hidden'); document.getElementById('mob-btn-run').classList.remove('hidden'); };
            document.getElementById('mob-btn-run').onclick = () => { document.getElementById('process-image').click(); };
            
            const toggleModule = (btnId, contentId, iconId) => { const btn = document.getElementById(btnId), content = document.getElementById(contentId), icon = document.getElementById(iconId); if(btn) btn.addEventListener('click', () => { content.classList.toggle('open'); icon.style.transform = content.classList.contains('open') ? 'rotate(180deg)' : 'rotate(0deg)'; }); };
            ['toggle-processing', 'toggle-subject', 'toggle-identity', 'toggle-prompt', 'toggle-logo', 'toggle-military', 'toggle-cinematic', 'toggle-exposure'].forEach(id => toggleModule(id, id.replace('toggle', 'content'), id.replace('toggle', 'icon')));
            
            if(fileInput) fileInput.addEventListener('change', (e) => { if (e.target.files.length > 0) { const mUpload = document.getElementById('mob-btn-upload'), mScan = document.getElementById('mob-btn-scan'), mStatus = document.getElementById('mobile-status-text'); if(mUpload && mScan) { mUpload.classList.add('hidden'); mScan.classList.remove('hidden'); mStatus.textContent = "IMAGE LOADED - PRESS SCAN"; mStatus.classList.add('text-violet-400'); } loadImg(e.target.files[0]); e.target.value = ''; } });
            function loadImg(file) { const reader = new FileReader(); reader.onload = (e) => { state.base64 = e.target.result; const img = new Image(); img.onload = () => { state.originalImg = img; document.getElementById('img-original').src = state.base64; document.getElementById('comparison-view').style.display = 'flex'; document.getElementById('placeholder-state').style.display = 'none'; }; img.src = e.target.result; }; reader.readAsDataURL(file); }
        });
    </script>
</body>
</html>